select * 
from news n
where n.event in 

select e.name, e.date, e.time, v.name as vanue, s.name as sport
from events e, vanues  v, sports s
where e.vanue = v.id and e.sport = s.id
order by e.date , e.time
limit 3

select *
from vanues

select *
from sports

insert into events values
("400M FREESTYLE MEN", date("now"), time("now"),1, (select id from sports where name like "Swimming"))

select * from events

update events set sport=2 where oid = 5

insert into news (title, date, time, content, event, user) values 
(select title, date("now"), time("now"), content, event, user from news)


select id, event from news

update news set event = (select name from events where oid = 2) where id = 1

select e.name, s.name
from events e, sports s
where e.sport = s.id

select n.title as title,n.id as  news_link,  e.name as event, e.name as  events_link, s.name as sport,  s.id as  sports_link, n.datetime as datetime
from news n, events e, sports s
where n.event = e.name and e.sport = s.id

select n.title as title,n.id as  news_link, 
n.datetime as date, n.user as reporter, n.content as content,
p.link as pic
from news n, news_pics np, pictures p
where np.news = n.id and np.pic = (select id from pictures limit 1)

select s.name as sport, s.id as sports_link
from sports s

select * from news
create table pictures (
	id integer primary key autoincrement not null,
	link varchar(500) not null,
	des varchar(500) not null
)
select * from pictures
select * from news_pics

insert into news_pics (news, pic, user) values
(5, 5,"yuankunluo")

insert into pictures(link, des) values
("001.jpg","test"),
("002.jpg", "LOve"),
("003.jpg","love"),
("004.jpg","love"),
("005.jpg","love")

select n.title as title,n.id as  news_link,  c.count as comment
n.datetime as date, n.user as reporter, n.content as content,
p.link as pic
from news n, news_pics np, pictures p, 
(select news ,count(oid) as count
from comments
group by news
order by  count) c
where np.news = n.id and np.pic = (select id from pictures limit 1) and c.


insert into comments (news, user, content,datetime) values
(5,"yuankunluo","i",datetime("now"))

select * from news
select * from vanues
select * from addresses

insert into addresses (post_code, line_1) values
("E161XL","Royal Victoria Dock")

insert into vanues (name, city, address) values
("Aquatics Centre",2,1),
("Basketball Arena",2,1),
("BMX Track",2,1),
("Eton Manor",2,1),
("Copper Box",2,1),
("Velodrome",2,1),
("Riverbank Arena",2,1),
("Olympic Stadium",2,1),
("Water Polo Arena",2,1)

select v.name as vanue, v.id as  vanue_link
from vanues v

select s.name as vanue, s.id as  vanue_link
from sports s

select e.name as event, e.name as event_link
from events e

select * from athelets

select name as name, a2_code as name_link
from countries;

select * from athelets;

select * from events
update events set name = lower(name)

insert into events values
("I LOVE YOU", date("now"), time("now"), 1, 15)

select * from addresses
update addresses set post_code = lower(post_code), line_2 = lower(line_2)

select * from athelets

update athelets set first_name = lower(first_name), last_name=lower(last_name),
gender= lower(gender), country = lower(country)

update cities set postcode = lower(postcode),
country = lower(country), state = lower(state), name = lower(name)

update countries 
 set name =  lower(name)

update news 
set title =  lower(title),event =  lower(event)

update paticipants set event = lower(event)

update sports set name = lower(name)

select * from users

update users set
last_name = lower(last_name)

update vanues set name = lower(n

create table athelets (
first_Name varchar(255) not null, 
last_Name varchar(255) not null, 
gender char(1) not null, 
birth_date varchar(255) not null, 
country varchar(5) not null,  
pic integer,
primary key(first_name, last_name, gender, birth_date, country),
foreign key (country) references countries(a2_code),
foreign key (pic) references pictrues(id)
)

select * from athletes

insert into athelets (first_name, last_name, gender, birth_date, country)
values
(lower("Michael") ,lower("Phelps"), lower("m"),date("1988-11-06"),"us" )

select a.*, c.name
from athelets a, countries c
where a.country = c.a2_code

select * from countries
where a2_code = "bd"


create table teams
( name varchar(255) not null,
country varchar(255) not null,
primary key(name, country),
foreign key(country) references  countries(a2_code)
)

select * from sports

select oid from events
where name = "i love you"

update events set date ="2000-01-01" where oid = 6

insert into events(name, date, time, vanue, sport, type)
values 
("i love you too i love love", date("1988-08-22"), time("16:44"),1,3,"p")

select * from events 
where name = "i love you"

update events set type = "f" where vanue = 1

create table athletes (
	firstname varchar(255) not null,
	lastname varchar(255) not null,
	gender char(1) not null,
	birthday varchar(255) not null,
	country char(2) not null,
	pic integer,
	primary key(firstname, lastname, gender, birthday,country),
	foreign key (country) references countries(a2_code),
	foreign key (pic) references pictures(id)
)

select * from athletes

insert into athletes(firstname, lastname,gender, birthday,country)
values
("yuankun","luo","f","1988-11-06","cn")

select * from events

delete from events where rowid >6
delete from participants where rowid >0
delete from athletes where rowid >0

create table participants (
	event varchar(255) not null,
	athlete integer not null,
	rank integer not null,
	team varchar(255),
	result varchar(255),
	medal char(1),
	foreign key (event) references events(name),
	foreign key (athlete) references athletes(oid),
	primary key (event, athlete)
)

CREATE TABLE events (
	id integer not null primary key autoincrement,
    "name" VARCHAR(255) NOT NULL,
    "date" VARCHAR(255) NOT NULL,
    "time" VARCHAR(255) NOT NULL,
    "vanue" INTEGER NOT NULL,
    "sport" V NOT NULL,
    "type" CHAR(1) NOT NULL
)
insert into events (name, date, time, vanue, sport, type)
values 
("400m swimmfffdfsfffdfs","1988-11-06","12:30","1","1","p")

CREATE TABLE participants (
	event integer not null,
	athlete integer not null,
	rank integer not null,
	team varchar(255),
	result varchar(255),
	medal char(1),
	foreign key (event) references events(id),
	foreign key (athlete) references athletes(oid),
	primary key (event, athlete)
)

select e.name as event, e.date as date, e.time as time, v.name as v.vanue


CREATE TABLE users (
id integer not null primary key autoincrement,
username varchar(255) not null,
email varchar(255) not null,
pass varchar(255) not null,
first_name varchar(255) not null,
last_name varchar(255) not null,
gender char(1) not null,
birth_date varchar(255) not null,
city integer not null,
address integer not null,
register_time varchar(255) not null,
face_pic varchar(255),
reporter boolean not null,
foreign key (city) references cities(id) on update no action on delete no action,
foreign key (address) references addresses(id) on update cascade on delete cascade,
foreign key (face_pic) references pictures(id) on update cascade on delete cascade
)

create table news (
	id integer not null primary key autoincrement,
	datetime varchar(255) not null,
	user integer not null,
	content text not null,
	title varchar(255) not null,
	event integer not null,
	foreign key(user) references users(id),
	foreign key(event) references events(id)
)

insert into news (datetime, user, content, title, event)
values 
(datetime("now"), 1,"I love you love you","i love you love you",1)

insert into users(username, email, pass, firstname, lastname, gender, birthday,city,address, registertime,reporter)
values 
("yuankun","y@q.com","123","Yuankun","Luo","m","1988-11-06",1,1,datetime("now"), 0)

CREATE TABLE users (
    "id" INTEGER NOT NULL primary key,
    "username" VARCHAR(255) NOT NULL,
    "email" VARCHAR(255) NOT NULL,
    "pass" VARCHAR(255) NOT NULL,
    "firstname" VARCHAR(255) NOT NULL,
    "lastname" VARCHAR(255) NOT NULL,
    "gender" CHAR(1) NOT NULL,
    "birthday" VARCHAR(255) NOT NULL,
    "city" INTEGER NOT NULL,
    "address" INTEGER NOT NULL,
    "registertime" VARCHAR(255) NOT NULL,
    "facepic" VARCHAR(255),
    "reporter" BOOLEAN NOT NULL,
    foreign key (city) references cities(id),
    foreign key(address) references addresses(id),
    foreign key(facepic) references pictures(id)
)

select e.name as event, e.date, e.time, v.name as vanue,
s.name as sport
from events e, vanues  v, sports s 
where e.vanue = v.id and e.sport = s.id and e.id =1



select n.title as title,n.id as news_link, n.datetime as date, 
n.user as reporter, n.content as content,p.link as pic, s.name as sport, s.id as sports_link, c.count as comment
from news n, pictures p, events as e, sports as s,
(select news as cid,count(oid) as count
from comments
group by cid
order by  count) c, 
(select news as nid , pic as pid
from news_pics
group by news) np
where np.nid = n.id and n.id = np.nid and np.pid = p.id and c.cid= n.id and n.event = e.name and e.sport = s.id
order by comment desc
limit 10



select n.title as title,n.id as news_link, n.datetime as date, 
u.name as reporter, n.content as content,p.link as pic, s.name as sport, 
s.id as sports_link, c.count as comment
from news n, pictures p, events e, sports  s, users u,
(select news as cid,count(oid) as count
from comments
group by cid
order by  count) c, 
(select news as nid , pic as pid
from news_pics
group by news) np
where np.nid = n.id and n.id = np.nid and np.pid = p.id and c.cid= n.id and n.event = e.name and e.sport = s.id
order by comment desc
limit 10

select news as cid,count(oid) as count
	from comments
	group by cid
	order by  count

select news as nid , pic as pid
	from news_pics
	group by news
	
	
select n.title as title,n.id as news_link, n.datetime as date, 
u.name as reporter, n.content as content,p.link as pic, s.name as sport, 
s.id as sports_link, c.count as comment
from news n, pictures p, events e, sports  s, users u,
	(select news as cid,count(oid) as count
	from comments
	group by cid
	order by  count) c, 
	(select news as nid , pic as pid
	from news_pics
	group by news) np
where np.nid = n.id and n.id = np.nid and np.pid = p.id and c.cid= n.id and n.event = e.id and e.sport = s.id and e.id = 1
order by comment desc


select e.name as event, e.id as event_link
from events e

select s.name as sport, s.id as  sport_link
from sports s



select n.title as title,n.id as news_link, n.datetime as date, 
u.name as reporter, n.content as content,p.link as pic, s.name as sport, 
s.id as sports_link, c.count as comment
from news n, pictures p, events e, sports  s, users u,
	(select news as cid,count(oid) as count
	from comments
	group by cid
	order by  count) c, 
	
	(select news as nid , pic as pid
	from news_pics
	group by news) np
where np.nid = n.id and n.id = np.nid and np.pid = p.id and c.cid= n.id and n.event = e.id and e.sport = s.id
order by comment desc

select (a.firstname || " "||a.lastname) as athlete, a.rowid as athletes_link,
p.rank as rank, p.medal as medal, 
from events e, participants p, athletes a
where e.id = p.event and p.athlete = a.rowid and e.id=8
order by rank

select n.title as title, n.id as news_link, u.name as reporter 
from news n,  events e, users u
where n.event = e.id and e.id = 8



select e.name as event, e.id as events_link,e.date, e.time, v.name as vanue,
s.name as sport, s.id as sports_link
from events e, vanues  v, sports s 
where e.vanue = v.id and e.sport = s.id
order by date,time 

select n.title as title, n.id as news_link, n.datetime, u.name as reporter,e.name as event, e.id as events_link
from news n, events e, users u
where n.event = e.id and n.user = u.id
order by datetime, event

select s.name as sport, s.id as sports_link, c.event_count as events, s.id as events_link
from sports s,
	(select count(e.id) as event_count, e.sport as sport
	from events e
	group by sport) c
where s.id = c.sport

select (a.firstname || " " || a.lastname) as name, a.rowid as athletes_link, a.birthday as birthday, c.name as country
from athletes a, countries c
where a.country = c.a2_code
group by country, name


select (a.firstname || " "||a.lastname) as athlete, a.rowid as athletes_link,
p.rank as rank, p.medal as medal, c.name as country, p.team as team
from events e, participants p, athletes a, countries c
where e.id = p.event and p.athlete = a.rowid and a.country = c.a2_code and e.id=?
order by rank

CREATE TABLE participants (
	event integer not null,
	athlete integer not null,
	rank integer not null,
	team varchar(255) default "",
	result varchar(255) default "",
	medal char(1) default "",
	foreign key (event) references events(id),
	foreign key (athlete) references athletes(oid),
	primary key (event, athlete)
)

CREATE TABLE athletes (
	firstname varchar(255) not null,
	lastname varchar(255) not null,
	gender char(1) not null,
	birthday varchar(255) not null,
	country char(2) not null,
	pic integer default "person.jpg",
	primary key(firstname, lastname, gender, birthday,country),
	foreign key (country) references countries(a2_code),
	foreign key (pic) references pictures(id)
)

CREATE TABLE addresses (
	id integer primary key autoincrement,
	post_code char(10) not null,
	line_1 varchar(255) not null,
	line_2 varchar(255) default ""
)
CREATE TABLE cities (
	id integer primary key autoincrement, 
	postcode varchar(20) not null,
	country char(2) not null,
	state varchar(255) not null,
	name varchar(255) not null,
	foreign key (country) references countries(a2_code) on update no action  on delete no action
)

CREATE TABLE athletes (
	id integer not null primary key autoincrement,
	firstname varchar(255) not null,
	lastname varchar(255) not null,
	gender char(1) not null,
	birthday varchar(255) not null,
	country char(2) not null,
	pic integer default "person.jpg",
	foreign key (country) references countries(a2_code),
	foreign key (pic) references pictures(id)
)

-- Describe EVENTS
CREATE TABLE events (
    "id" INTEGER NOT NULL primary key,
    "name" VARCHAR(255) NOT NULL,
    "date" VARCHAR(255) NOT NULL,
    "time" VARCHAR(255) NOT NULL,
    "vanue" INTEGER NOT NULL,
    "sport" V NOT NULL,
    "type" VARCHAR(255) NOT NULL
)


select e.name as event, e.date, e.time, v.name as vanue, e.type as type,
s.name as sport, s.id as sports_link
from events e, vanues  v, sports s 
where e.vanue = v.id and e.sport = s.id and e.id =?

delete from participants where rowid >=0


select e.name as event, e.id as events_link,e.date, e.time, v.name as vanue,
s.name as sport, s.id as sports_link
from events e, vanues  v, sports s 
where e.vanue = v.id and e.sport = s.id and e.type like "Team%"
order by sport,date,time

select * from events
where type like "Solo%"

select (name || " -- " || type) as name, id as events_link
from events


-- Describe NEWS
CREATE TABLE news (
	id integer not null primary key autoincrement,
	datetime varchar(255) not null,
	user integer not null,
	content text not null,
	title varchar(255) not null,
	event integer default 0,
	foreign key(user) references users(id),
	foreign key(event) references events(id)
)


-- Describe USERS
CREATE TABLE users (
    "id" INTEGER NOT NULL primary key autoincrement,
    "name" VARCHAR(255) NOT NULL,
    "email" VARCHAR(255) NOT NULL,
    "pass" VARCHAR(255) NOT NULL,
    "firstname" VARCHAR(255) NOT NULL,
    "lastname" VARCHAR(255) NOT NULL,
    "gender" CHAR(1) NOT NULL,
    "birthday" VARCHAR(255) NOT NULL,
    "address" INTEGER NOT NULL,
    "registertime" VARCHAR(255) NOT NULL,
    "pic" VARCHAR(255) default "person.jpg",
    "reporter" BOOLEAN NOT NULL,
    "country" integer not null,
    foreign key(pic) references pictures(id),
    foreign key(address) references address(id),
    foreign key(country) references country(a2_code)
)

-- Describe USERS
CREATE TABLE users (
    "id" INTEGER NOT NULL primary key autoincrement,
    "email" VARCHAR(255) NOT NULL,
    "password" VARCHAR(255) NOT NULL,
    "firstname" VARCHAR(255) NOT NULL,
    "lastname" VARCHAR(255) NOT NULL,
    "gender" CHAR(1) NOT NULL,
    "birthday" VARCHAR(255) NOT NULL,
    "address" INTEGER NOT NULL,
    "registertime" VARCHAR(255) NOT NULL,
    "pic" VARCHAR(255) default "person.jpg",
    "reporter" BOOLEAN default 0 ,
    "country" integer not null,
    foreign key(pic) references pictures(id),
    foreign key(address) references address(id),
    foreign key(country) references country(a2_code)
)

select n.title as title,n.id as news_link, n.datetime as date, 
(u.firstname ||" "||u.lastname )as reporter, n.content as content,p.link as pic, s.name as sport, 
s.id as sports_link, c.count as comment
from news n, pictures p, events e, sports  s, users u,
	(select news as cid,count(oid) as count
	from comments
	group by cid
	order by  count) c, 
	
	(select news as nid , pic as pid
	from news_pics
	group by news) np
where np.nid = n.id and n.id = np.nid and np.pid = p.id and c.cid= n.id and n.event = e.id and e.sport = s.id
order by comment desc


-- Describe USERS
CREATE TABLE users (
    "id" INTEGER NOT NULL primary key autoincrement,
    "email" VARCHAR(255) NOT NULL,
    "password" VARCHAR(255) NOT NULL,
    "firstname" VARCHAR(255) NOT NULL,
    "lastname" VARCHAR(255) NOT NULL,
    "gender" CHAR(1) NOT NULL,
    "birthday" VARCHAR(255) NOT NULL,
    "registertime" VARCHAR(255) NOT NULL,
    "pic" VARCHAR(255) default "person.jpg",
    "reporter" BOOLEAN default 0 ,
    foreign key(pic) references pictures(id)
)

-- Describe COMMENTS
CREATE TABLE comments (
	id integer  primary key autoincrement,
	news integer not null,
	user integer not null,
	content text not null,
	datetime  varchar(255) not null,
	foreign key (news) references news(id) on delete no action on update no action,
	foreign key (user) references users(id) on delete no action on update no action
)


-- Describe NEWS_PICS
CREATE TABLE news_pics (
	id integer  primary key autoincrement,
	news integer not null,
	pic integer not null,
	user varchar(255) not null,
	foreign key (news) references news(id) on delete no action on update no action,
	foreign key (pic) references pictures(id) on delete cascade on update cascade,
	foreign key (user) references users(id) on delete no action on update no action
)

-- Describe VANUES2
CREATE TABLE vanues2 (
	id integer primary key autoincrement,
	name varchar(255 ) not null
)

insert into vanues2(name)
select name 
from vanues


-- Describe USERS
CREATE TABLE users (
    "id" INTEGER NOT NULL p
    rimary key autoincrement,
    "name" varchar(255) not null,
    "email" VARCHAR(255) NOT NULL,
    "password" VARCHAR(255) NOT NULL,
    "firstname" VARCHAR(255) NOT NULL,
    "lastname" VARCHAR(255) NOT NULL,
    "gender" CHAR(1) NOT NULL,
    "birthday" VARCHAR(255) NOT NULL,
    "country" varchar(255) not null,
    "registertime" VARCHAR(255) NOT NULL,
    "pic" VARCHAR(255) default "person.jpg",
    "reporter" BOOLEAN default 0 ,
    foreign key(pic) references pictures(id),
    foreign key(country) references countries(a2_code)
)


insert into news (datetime, user, content, title, event)
values 

-- Describe USERS
CREATE TABLE users (
    "id" INTEGER NOT NULL primary key autoincrement,
    "name" varchar(255) not null,
    "email" VARCHAR(255) NOT NULL,
    "password" VARCHAR(255) NOT NULL,
    "firstname" VARCHAR(255) NOT NULL,
    "lastname" VARCHAR(255) NOT NULL,
    "gender" CHAR(1) NOT NULL,
    "birthday" VARCHAR(255) NOT NULL,
    "country" varchar(255) not null,
    "registertime" VARCHAR(255) NOT NULL,
    "pic" VARCHAR(255) default "person.jpg",
    "reporter" BOOLEAN default 0 ,
    foreign key(pic) references pictures(id),
    foreign key(country) references countries(a2_code)
)
CREATE TABLE users (
    "id" INTEGER NOT NULL primary key autoincrement,
    "name" varchar(255) not null,
    "email" VARCHAR(255) NOT NULL,
    "password" VARCHAR(255) NOT NULL,
    "firstname" VARCHAR(255) NOT NULL,
    "lastname" VARCHAR(255) NOT NULL,
    "gender" CHAR(1) NOT NULL,
    "birthday" VARCHAR(255) NOT NULL,
    "country" varchar(255) not null,
    "registertime" VARCHAR(255) not null,
    "pic" VARCHAR(255) default "person.jpg",
    "reporter" BOOLEAN default 0 ,
    foreign key(pic) references pictures(id),
    foreign key(country) references countries(a2_code)
)

select datetime("now")




-- Describe EVENTS2
CREATE TABLE "events" (
    "id" INTEGER NOT NULL primary key,
    "name" VARCHAR(255) NOT NULL,
    "date" VARCHAR(255) NOT NULL,
    "time" VARCHAR(255) NOT NULL,
    "vanue" INTEGER NOT NULL,
    "sport" V NOT NULL,
    "type" VARCHAR(255) NOT NULL,
    "user" integer not null default 1,
    foreign key (vanue) references vanues(id),
    foreign key (sport) references sports(id),
    foreign key (user) references users(id)
)

select * from events

insert into events (name, date, time, vanue, sport, type)
select name, date, time, vanue, sport, type 
from events2

select n.title as title, n.id as news_link, n.datetime, u.name as reporter,e.name as event, e.id as events_link
from news n, events e, users u
where n.event = e.id and n.user = u.id
order by datetime, event

delete from news where rowid >0